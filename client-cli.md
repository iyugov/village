# Создание хоста консольного клиента

## Описание

Настраивается клиент на базе Ubuntu Server 24.04, получающий сетевые настройки от DHCP-сервера.

## Требования

* [Создание DHCP-сервера](dhcp.md)

## Выполнение

1. Создадим виртуальную машину VirtualBox со следующими параметрами:
    * имя - "Client 1";
    * ОС - Linux, Ubuntu (64-bit);
    * объём оперативной памяти - 2048 Мб, процессоры - 1;
    * накопитель SATA, 15 Гб;
    * оптический привод для установочного образа;
    * 1 сетевой адаптер: имеет тип Generic Driver с именем UDPTunnel.

2. Добавим виртуальную машину в GNS3 через шаблон с именем "Client1".

3. Установим управление GNS3 для сетевых интерфейсов приложения и зададим число сетевых адаптеров - 1.

4. Подключим сетевой интерфейс `Ethernet0` виртуальной машины к сетевому интерфейсу `ether2` роутера "ClientRouter".

5. Загрузим виртуальную машину с установочного образа Ubuntu Server 24.04.1 LTS.

6. В меню загрузки выберем "Try or Install Ubuntu Server" и дождёмся окончания загрузки.

7. Выберем язык "English". Выберем раскладку клавиатуры "Russian" и вариант "Russian". Определим клавишу "Caps Lock" для переключения раскладок.

8. Выберем вариант установки "Ubuntu Server".

9. Если параметры сети определятся автоматически, то примем их, иначе пропустим настройку сети (продолжим без доступа к сети).

10. Оставим настройку прокси пустой.

11. Для разметки накопителей выберем "Use an entire disk" с установленной настройкой "Set up this disk as an LVM group".

12. Проверим разметку, завершим её, согласимся на изменения.

13. Зададим отображаемое имя пользователя "User", имя сервера "client1", имя пользователя "user"; зададим пароль пользователя.

14. Пропустим настройку Ubuntu Pro.

15. Отметим установку сервера OpenSSH.

16. Дождёмся окончания установки. Перезагрузим хост. Авторизуемся.

17. Откроем файл настроек сети:

    ```sh
    sudo vim /etc/netplan/50-cloud-init.yaml
    ```

18. Убедимся, что в файле включено получение сетевых настроек по DHCP:

    ```config
    network:
      version: 2
      renderer: networkd
      ethernets:
        enp0s3:
          dhcp4: true
    ```

    Если таких настроек нет, то обеспечим их.  
    Сохраним изменения, выйдем из редактора (`Esc`, `Shift`+`z`, `Shift`+`z`).  

19. Применим настройка netplan:

    ```sh
    sudo netplan apply
    ```

20. Если настройки сети были добавлены или изменены, то выключим и включим соответствующий сетевой интерфейс (пример для `enp0s3`):

    ```sh
    sudo ip link set enp0s3 down
    sudo ip link set enp0s3 up
    ```

21. Отобразим настройки сетевых интерфейсов:

    ```sh
    ip address
    ```

    Для сетевого интерфейса должен быть получен IP-адрес из пула 172.16.0.101-172.16.0.200 (скорее всего, 172.16.0.101).

22. Отобразим маршруты:

    ```sh
    ip route
    ```

    В списке маршрутов должен быть маршрут по умолчанию через хост 172.16.0.101.

23. проверим разрешение имён:

    ```sh
    nslookup ns
    nslookup 10.0.1.3
    ```

    Разрешение имён должно происходить успешно.
